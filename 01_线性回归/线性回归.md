# 线性回归

​		np.ndarray 可以有 1 ~ n 维, np.matrix 的矩阵是 2 维. 在线性回归中主要涉及到一维数组和二维数组/矩阵的运算. 

<font size=5 color=brown>***线性回归的实现过程***</font>

- Step1: hypothesis

$$
h_{\theta}(x) =  X{\theta}^T    \\
h_{\theta}(x^{(i)}) = {\theta}_0 + {\theta}_1 x_1 + {\theta}_2 x_2 + ... + {\theta}_n x_n   \\
{\theta} = ({\theta} _0, {\theta} _1, {\theta}_2, ..., {\theta}_n) 	\\
X = (x^{(0)}, x^{(1)},  x^{(2)}, ...,  x^{(m)} )^{T}   \\
x^{(i)} = (x_0, x_1, x_2, ..., x_n)
$$

<img src="https://images.gitee.com/uploads/images/2020/0922/174435_fd5ae3ea_8098130.jpeg" title="线性回归.jpg" style="zoom: 25%;" />





- Step2: Cost Function

$$
J({\theta}) = \frac{1}{2m} \sum_{i=1}^m(h_{\theta}(x^{(i)}) - y^{(i)})^2
$$

- Step3: Gradient Descent

$$
{\theta}_j = {\theta}_j - {\alpha}\frac{\partial{J_{\theta}}}{\partial{\theta}_j}
$$

$$
\frac{\partial{J_{\theta}}}{\partial{\theta}_j} = 
\frac{1}{m} \sum_{i=1}^mnp.multiply((h_{\theta}(x^{(i)}) - y^{(i)}), X[:, j]), 
\space for \space j\space in \space range(n)
$$



## <font size=5 color=brown>***如何用 Numy 实现公式的 Code***</font>

- 方法一: 用数组的方式, 在算矩阵乘法时用np.dot(array1, array2). 如计算 $ h_{\theta}(x) $
- 方法二: 用矩阵的方式, 定义为矩阵, 直接用 * 计算矩阵乘法

```+python
X = np.array([[1, 2, 3],   					#  2d.array   (4, 3)
              [1, 3, 4],
              [1, 4, 5],
              [1, 5, 6]])
theta = np.array([0.1, 0.2, 0.3])   		# 1d.array   (3,)

X_mat = np.mat(X)							# matrix	(4, 3)		
theta_mat = np.mat(theta)				    # matrix    (1,3)

"""
np.dot(a, b):
若都为一维向量,则结果为向量点积;
若都为二维向量,则结果为矩阵乘法,当然要保持行列对应才能进行矩阵乘法;
若前者为二维向量(也就是矩阵),后者为一维向量,则后者会被当做一维矩阵进行计算
"""
h1 = np.dot(X, theta) 				# 1d.array    (4,)
h2 = X_mat * theta_mat.T            # matrix      (4,1)
h3 = np.dot(X_mat, theta_mat.T)     # matrix      (4,1)

"""
np.multiply(a, b) 对应位置相乘, a b互换位置结果一样
a = [[1, 2, 3],          b = [1 , 2, 3] 或 b = [[1],
	 [1, 3, 4],                                 [2],
	 [1, 4, 5],                                 [3],
	 [1, 5, 6]]									[4]]
"""
```

<img src="C:\Users\yz\AppData\Roaming\Typora\typora-user-images\image-20200922190049439.png" alt="image-20200922190049439" style="zoom: 25%;" />